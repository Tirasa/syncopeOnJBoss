<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd">

  <import resource="domains/*Domain.xml"/>
  
  <bean class="org.apache.syncope.core.persistence.jpa.spring.DomainTransactionInterceptorInjector"/>
  
  <bean id="commonEMFConf" class="org.apache.syncope.core.persistence.jpa.spring.CommonEntityManagerFactoryConf">
    <property name="packagesToScan" value="org.apache.syncope.core.persistence.jpa.entity"/>
    <property name="validationMode" value="NONE"/>
    <property name="persistenceUnitPostProcessors">
      <list>
        <bean class="org.apache.syncope.core.persistence.jpa.spring.MultiJarAwarePersistenceUnitPostProcessor"/>
      </list>
    </property>
    <property name="jpaPropertyMap">
      <map>
        <entry key="openjpa.Log" value="slf4j"/>
        <!--<entry key="openjpa.Log" value="SQL=TRACE"/>
        <entry key="openjpa.ConnectionFactoryProperties" 
        value="PrintParameters=true, PrettyPrint=true, PrettyPrintLineLength=80"/>-->
                                
        <entry key="openjpa.NontransactionalWrite" value="false"/>

        <!-- Removed: see https://s.apache.org/openjpaSchemaFactory for more information
        <entry key="openjpa.jdbc.SchemaFactory" value="native(ForeignKeys=true)"/>-->
        <entry key="openjpa.jdbc.MappingDefaults" 
               value="ForeignKeyDeleteAction=restrict, JoinForeignKeyDeleteAction=restrict"/>
                
        <entry key="openjpa.DataCache" value="true"/>
        <entry key="openjpa.QueryCache" value="true"/>
        <entry key="openjpa.RemoteCommitProvider" value="sjvm"/>
      </map>
    </property>
  </bean>
  
</beans>
